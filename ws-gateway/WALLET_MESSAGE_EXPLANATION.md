# Объяснение сообщения wallet от Bybit WebSocket

## Структура сообщения

```json
{
  "id": "106414639_wallet_1764099264683",  // Уникальный ID сообщения
  "topic": "wallet",                        // Топик подписки
  "creationTime": 1764099264682,           // Время создания (Unix timestamp в миллисекундах)
  "data": [...]                             // Массив данных о балансе
}
```

## Основные поля в data[0]

### Общие балансы аккаунта:
- **totalEquity**: `1961.91268327` - Общий капитал (equity) аккаунта
- **totalWalletBalance**: `103.10397979` - Общий баланс кошелька
- **totalMarginBalance**: `103.10397979` - Общий маржинальный баланс
- **totalAvailableBalance**: `103.10397979` - Общий доступный баланс (для торговли)

### Маржинальные параметры:
- **totalInitialMargin**: `0` - Общая начальная маржа
- **totalMaintenanceMargin**: `0` - Общая поддерживающая маржа
- **accountIMRate**: `0` - Начальная маржинальная ставка аккаунта
- **accountMMRate**: `0` - Поддерживающая маржинальная ставка аккаунта

### PnL:
- **totalPerpUPL**: `0` - Общий нереализованный PnL по перпетуальным контрактам

### Тип аккаунта:
- **accountType**: `UNIFIED` - Единый аккаунт (unified account)

## Данные по монетам (coin[])

В массиве `coin` содержатся данные по каждой валюте:

### Для USDT:
- **coin**: `USDT` - Символ валюты
- **equity**: `103.14895274` - Капитал в этой валюте
- **usdValue**: `103.10397979` - Стоимость в USD
- **walletBalance**: `103.14895274` - Баланс кошелька
- **availableToWithdraw**: `` - Доступно для вывода (пусто, значит не указано)
- **locked**: `0` - Заблокированный баланс
- **unrealisedPnl**: `0` - Нереализованный PnL
- **cumRealisedPnl**: `0` - Накопленный реализованный PnL
- **bonus**: `3` - Бонусы
- **collateralSwitch**: `true` - Используется как залог
- **marginCollateral**: `true` - Можно использовать для маржи

## Когда приходит это сообщение?

Сообщение приходит при:
1. Первой подписке на `wallet` (snapshot текущего состояния)
2. Любом изменении баланса:
   - Депозит средств
   - Вывод средств
   - Исполнение ордера
   - Начисление/списание комиссий
   - Изменение нереализованного PnL
   - Изменение маржинальных требований

## Как использовать в системе?

Это сообщение должно:
1. Парситься и сохраняться в таблицу `account_balances`
2. Отправляться в RabbitMQ очередь для других сервисов
3. Обновлять состояние баланса в реальном времени

