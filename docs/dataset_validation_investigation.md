# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞ `dataset_data_quality_validation_failed` –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –≤—Å–µ —Ñ–∏—á–∏ –∑–∞ –≤—Å–µ –¥–Ω–∏ - –ø—É—Å—Ç—ã–µ, —Ö–æ—Ç—è:
- –†–∞—Å—á—ë—Ç —Ñ–∏—á –∏ —Ç–∞—Ä–≥–µ—Ç–∞ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ (–ø–æ—Å–ª–µ 16:40) —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–æ –ª–æ–≥–∞–º –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Ä–∞—Å—á—ë—Ç–∞
- Endpoint `/dataset/compute-features` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

## –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. **–†–∞—Å—á—ë—Ç —Ñ–∏—á** (`build_dataset_streaming`):
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç timestamps –¥–ª—è –ø–µ—Ä–∏–æ–¥–∞
   - –í—ã–∑—ã–≤–∞–µ—Ç `compute_features_batch` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞—Ç—á–∞
   - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: `pd.concat(all_features, ignore_index=True)`
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ –ø–æ Feature Registry (—Å—Ç—Ä–æ–∫–∞ 427)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `filtered_df`

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ç—ã —Ñ–∏—á** (`_validate_feature_completeness`, —Å—Ç—Ä–æ–∫–∞ 362):
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–ï–†–ï–î `_validate_data_quality`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ —Ñ–∏—á–∏ –∏–∑ Feature Registry –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —É –∫–∞–∂–¥–æ–π —Ñ–∏—á–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –Ω–µ-NaN –∑–Ω–∞—á–µ–Ω–∏–µ
   - **–í–ê–ñ–ù–û**: –ï—Å–ª–∏ —ç—Ç–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç, –∑–Ω–∞—á–∏—Ç —Ñ–∏—á–∏ –ï–°–¢–¨ –∏ –∏–º–µ—é—Ç –¥–∞–Ω–Ω—ã–µ

3. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–æ–≤** (`_compute_targets`, —Å—Ç—Ä–æ–∫–∞ 386):
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï `_validate_feature_completeness`
   - –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π DataFrame `merged` —á–µ—Ä–µ–∑ merge —Å price_df
   - **–í–ê–ñ–ù–û**: –ù–µ –∏–∑–º–µ–Ω—è–µ—Ç `features_df` - —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏—é –¥–ª—è merge
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ `targets_df`, –Ω–µ –∏–∑–º–µ–Ω—è—è `features_df`

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö** (`_validate_data_quality`, —Å—Ç—Ä–æ–∫–∞ 408):
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï `_validate_feature_completeness` –∏ `_compute_targets`
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û –∑–∞–ø–∏—Å–∏ –Ω–∞ –¥–∏—Å–∫
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å DataFrame –≤ –ø–∞–º—è—Ç–∏ (`features_df`)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç NaN —á–µ—Ä–µ–∑ `isna()` –∏ —è–≤–Ω—ã–µ `None` –∑–Ω–∞—á–µ–Ω–∏—è
   - –°—á–∏—Ç–∞–µ—Ç `nan_ratio` –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∏—á–∏
   - **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–û–¢–ò–í–û–†–ï–ß–ò–ï**: –ï—Å–ª–∏ `_validate_feature_completeness` –ø—Ä–æ—à–ª–∞, –Ω–æ `_validate_data_quality` –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –≤—Å–µ –ø—É—Å—Ç—ã–µ - –∑–Ω–∞—á–∏—Ç –ª–∏–±–æ:
     - `features_df` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –≤–∞–ª–∏–¥–∞—Ü–∏—è–º–∏ (–Ω–æ `_compute_targets` –Ω–µ –¥–æ–ª–∂–µ–Ω –µ–≥–æ –º–µ–Ω—è—Ç—å)
     - –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ª–æ–≥–∏–∫–µ –ø–æ–¥—Å—á—ë—Ç–∞ NaN –≤ `_validate_data_quality`

5. **Split** (—Å—Ç—Ä–æ–∫–∞ 452/456):
   - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç `features_df` –∏ `targets_df` —á–µ—Ä–µ–∑ `merge(..., how="inner")`
   - –†–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º

6. **–ó–∞–ø–∏—Å—å** (`_write_dataset_splits`, —Å—Ç—Ä–æ–∫–∞ 461):
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ `to_parquet(..., index=False)`

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫ –≤ `build_dataset_streaming`

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ Feature Registry (—Å—Ç—Ä–æ–∫–∞ 427) —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ñ–∏—á–∏, –µ—Å–ª–∏ –∏–º–µ–Ω–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –°—Ä–∞–≤–Ω–∏—Ç—å –∏–º–µ–Ω–∞ —Ñ–∏—á –≤ `features_df.columns` —Å `registry_feature_names`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ `streaming_dataset_build_completed` - `original_feature_columns` vs `kept_feature_columns`
- –í–æ–∑–º–æ–∂–Ω–æ, –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ –∏–º–µ–Ω–∞—Ö (—Ä–µ–≥–∏—Å—Ç—Ä, –ø—Ä–µ—Ñ–∏–∫—Å—ã, —Å—É—Ñ—Ñ–∏–∫—Å—ã)

**–ö–æ–¥**:
```python
# –°—Ç—Ä–æ–∫–∞ 416-427
registry_feature_names = {f.name for f in feature_registry.features}
allowed_columns = ["timestamp"] + [
    col for col in original_columns
    if col != "timestamp" and col in registry_feature_names
]
filtered_df = features_df[allowed_columns]
```

### 2. –ü—Ä–æ–±–ª–µ–º–∞ –≤ `compute_features_batch` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DataFrame —Å NaN

**–ì–∏–ø–æ—Ç–µ–∑–∞**: `HybridFeatureComputer.compute_features_batch` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DataFrame, –≥–¥–µ –≤—Å–µ —Ñ–∏—á–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã NaN, —Ö–æ—Ç—è —Ä–∞—Å—á—ë—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–æ–ª–æ–Ω–æ–∫ (—Å—Ç—Ä–æ–∫–∞ 613 –≤ `hybrid_feature_computer.py`)
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏–π (—Å—Ç—Ä–æ–∫–∞ 698)
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö - –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å, –Ω–æ —Å—á–∏—Ç–∞—é—Ç—Å—è NaN
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ Feature Registry –≤–Ω—É—Ç—Ä–∏ `compute_features_batch`

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `compute_features_batch` - —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `result.at[idx, feature_name] = value` –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–º DataFrame

### 3. –ü—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á—ë—Ç NaN ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ NaN, —Ö–æ—Ç—è `_validate_feature_completeness` –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ.

**–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–û–¢–ò–í–û–†–ï–ß–ò–ï**:
- `_validate_feature_completeness` (—Å—Ç—Ä–æ–∫–∞ 362) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: `feature_series.isna().all()` –∏ `non_null_count == 0`
- –ï—Å–ª–∏ —ç—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –Ω–µ-NaN –∑–Ω–∞—á–µ–Ω–∏–µ
- –ù–æ `_validate_data_quality` (—Å—Ç—Ä–æ–∫–∞ 408) –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è NaN
- **–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –≤–∞–ª–∏–¥–∞—Ü–∏—è–º–∏ —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –≤ DataFrame!**

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö** - –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å, –Ω–æ `isna()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞
- **–ü—Ä–æ–±–ª–µ–º–∞ —Å `None` vs `NaN`** - –¥–ª—è object dtype –ø—Ä–æ–≤–µ—Ä–∫–∞ `== None` –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏** –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ "–ø—É—Å—Ç—ã–º–∏" –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è NaN
- **–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ—Å–ª–µ `_compute_targets`** - –º–æ–∂–µ—Ç –±—ã—Ç—å, targets_df –∏–∑–º–µ–Ω—è–µ—Ç features_df –ø—Ä–∏ merge?

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 979-987):
```python
if feature_series.dtype == 'object':
    nan_count = feature_series.isna().sum()
    if feature_series.notna().any():
        none_count = (feature_series[feature_series.notna()] == None).sum()
        nan_count += none_count
else:
    nan_count = feature_series.isna().sum()
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –î–ª—è object dtype –ø—Ä–æ–≤–µ—Ä–∫–∞ `== None` –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è - —ç—Ç–æ numpy/pandas –æ–±—ä–µ–∫—Ç—ã.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –°—Ä–∞–≤–Ω–∏—Ç—å `features_df` –¥–æ –∏ –ø–æ—Å–ª–µ `_compute_targets`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ `features_df` –ø—Ä–∏ merge —Å `targets_df`
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–±–µ–∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏—è—Ö

### 4. –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ concat

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ü–æ—Å–ª–µ `pd.concat(all_features, ignore_index=True)` —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è NaN.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–Ω—ã—Ö –±–∞—Ç—á–∞—Ö
- –ü—Ä–æ–±–ª–µ–º–∞ —Å timezone-aware/naive timestamps
- –ü—Ä–æ–±–ª–µ–º–∞ —Å float/int —Å–º–µ—à–∏–≤–∞–Ω–∏–µ–º
- –ü—Ä–æ–±–ª–µ–º–∞ —Å object dtype - —Å—Ç—Ä–æ–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è NaN

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ –∏ –ø–æ—Å–ª–µ concat
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –±–∞—Ç—á–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–ª–æ–Ω–æ–∫

### 5. –ü—Ä–æ–±–ª–µ–º–∞ –≤ split - merge —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–ì–∏–ø–æ—Ç–µ–∑–∞**: `merge(..., how="inner")` –≤ split —É–¥–∞–ª—è–µ—Ç —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–æ timestamp.

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 1334):
```python
merged = features_df.merge(targets_df, on="timestamp", how="inner")
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –†–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã timestamp –≤ `features_df` –∏ `targets_df`
- Timezone –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é timestamp (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã vs —Å–µ–∫—É–Ω–¥—ã)
- –ï—Å–ª–∏ `targets_df` –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ –∏–º–µ–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã –¥–æ –∏ –ø–æ—Å–ª–µ merge
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ timestamp —Ñ–æ—Ä–º–∞—Ç–æ–≤

### 6. –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ Parquet

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ Parquet –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –∏–ª–∏ –∏–∑–º–µ–Ω—è—é—Ç—Å—è.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö - Parquet –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–∏–ø—ã
- –ü—Ä–æ–±–ª–µ–º–∞ —Å NaN –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ - Parquet –º–æ–∂–µ—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å NaN
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ - —Ö–æ—Ç—è `index=False`, –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π/—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö - —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 1567-1569):
```python
await asyncio.to_thread(
    split_df.to_parquet, file_path, index=False
)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª –æ–±—Ä–∞—Ç–Ω–æ –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å –∏—Å—Ö–æ–¥–Ω—ã–º DataFrame
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏

### 7. –ü—Ä–æ–±–ª–µ–º–∞ —Å —á—Ç–µ–Ω–∏–µ–º –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ (–µ—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–∏—Ç–∞–µ—Ç —Å –¥–∏—Å–∫–∞)

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –¥–∏—Å–∫–∞ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DataFrame –≤ –ø–∞–º—è—Ç–∏.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `features_df` –∏–∑ –ø–∞–º—è—Ç–∏, –∞ –Ω–µ —á–∏—Ç–∞–µ—Ç —Å –¥–∏—Å–∫–∞
- –ï—Å–ª–∏ –µ—Å—Ç—å —á—Ç–µ–Ω–∏–µ —Å –¥–∏—Å–∫–∞, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

### 8. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Å—Ç—ã–º–∏ –±–∞—Ç—á–∞–º–∏

**–ì–∏–ø–æ—Ç–µ–∑–∞**: `compute_features_batch` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ DataFrame –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–∞—Ç—á–µ–π, –∏ –æ–Ω–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `all_features`.

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 369-370):
```python
if not batch_features.empty:
    all_features.append(batch_features)
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –≤—Å–µ –±–∞—Ç—á–∏ –ø—É—Å—Ç—ã–µ, `all_features` –±—É–¥–µ—Ç –ø—É—Å—Ç—ã–º —Å–ø–∏—Å–∫–æ–º, –∏ –≤–µ—Ä–Ω—ë—Ç—Å—è –ø—É—Å—Ç–æ–π DataFrame.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –±–∞—Ç—á–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–∞—Ç—á –Ω–µ –ø—É—Å—Ç–æ–π

### 9. –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ Feature Registry - –∏–º–µ–Ω–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ò–º–µ–Ω–∞ —Ñ–∏—á –≤ `features_df` –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –∏–º–µ–Ω–∞–º–∏ –≤ Feature Registry.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –ü—Ä–µ—Ñ–∏–∫—Å—ã/—Å—É—Ñ—Ñ–∏–∫—Å—ã –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∏—á
- –†–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º Feature Registry
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ–∏—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `volume_3s`, `vwap_*`) –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ Registry

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å `original_columns` –∏ `registry_feature_names`
- –°—Ä–∞–≤–Ω–∏—Ç—å –∏–º–µ–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Feature Registry

### 10. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∫–æ–ª–æ–Ω–æ–∫ –≤ HybridFeatureComputer

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ö–æ–ª–æ–Ω–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ `None`, –Ω–æ –ø–æ—Ç–æ–º –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 613 –≤ `hybrid_feature_computer.py`):
```python
result[feature_name] = None
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ `compute_patterns` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –¥—Ä—É–≥–∏–º–∏ –∫–ª—é—á–∞–º–∏, –∏–ª–∏ –µ—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–ª–æ–Ω–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è `None`.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–µ–π (—Å—Ç—Ä–æ–∫–∞ 614-630)
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ñ–∏—á–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

### 11. –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ü—Ä–æ–±–ª–µ–º—ã —Å timezone-aware/naive timestamps –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ merge –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–ö–æ–¥** (—Å—Ç—Ä–æ–∫–∞ 398-409):
```python
if features_df["timestamp"].dt.tz is None:
    features_df["timestamp"] = features_df["timestamp"].dt.tz_localize(timezone.utc)
else:
    features_df["timestamp"] = features_df["timestamp"].dt.tz_convert(timezone.utc)
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ merge –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

### 12. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Å—Ç—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ì–∏–ø–æ—Ç–µ–∑–∞**: –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (klines, trades) —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø—É—Å—Ç—ã–º —Ñ–∏—á–∞–º.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Ö–æ–¥–∫–∞ üî¥

**–ú–µ–∂–¥—É `_validate_feature_completeness` –∏ `_validate_data_quality` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–æ-—Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è NaN!**

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. **`features_df` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≥–¥–µ-—Ç–æ –º–µ–∂–¥—É –≤–∞–ª–∏–¥–∞—Ü–∏—è–º–∏** (—Ö–æ—Ç—è `_compute_targets` –Ω–µ –¥–æ–ª–∂–µ–Ω –µ–≥–æ –º–µ–Ω—è—Ç—å)
2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö** - –∑–Ω–∞—á–µ–Ω–∏—è –µ—Å—Ç—å, –Ω–æ `isna()` —Å—á–∏—Ç–∞–µ—Ç –∏—Ö NaN
3. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å—Å—ã–ª–∫–∞–º–∏** - `features_df` –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Å—ã–ª–∫–æ–π, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
4. **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –ª–æ–≥–∏–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** - `_validate_data_quality` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç NaN

**–ù–ï–û–ë–•–û–î–ò–ú–û –ü–†–û–í–ï–†–ò–¢–¨**:
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `features_df` –ø–æ—Å–ª–µ `_validate_feature_completeness` –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —Ç–µ–º, —á—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ `_validate_data_quality`
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–±–µ–∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏—è—Ö
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ `features_df` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `_compute_targets` (—Ö–æ—Ç—è –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω)

## –ü–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –í `build_dataset_streaming` - —Ä–∞–∑–º–µ—Ä—ã –±–∞—Ç—á–µ–π, —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
   - –í `compute_features_batch` - —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
   - –í `_validate_data_quality` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–π —Ñ–∏—á–µ
   - –í split - —Ä–∞–∑–º–µ—Ä—ã –¥–æ –∏ –ø–æ—Å–ª–µ merge

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–µ–Ω–∞ —Ñ–∏—á**:
   - –°—Ä–∞–≤–Ω–∏—Ç—å –∏–º–µ–Ω–∞ –≤ `features_df.columns` —Å `registry_feature_names`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ `streaming_dataset_build_completed`

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**:
   - –î–æ –∏ –ø–æ—Å–ª–µ concat
   - –í –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–º DataFrame
   - –ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å merge –≤ split**:
   - –†–∞–∑–º–µ—Ä—ã –¥–æ –∏ –ø–æ—Å–ª–µ
   - –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ timestamp —Ñ–æ—Ä–º–∞—Ç–æ–≤

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ Parquet**:
   - –ü—Ä–æ—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤

6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é**:
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DataFrame –≤ –ø–∞–º—è—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–¥—Å—á—ë—Ç–∞ NaN

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Feature Registry
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ñ–∏—á–∏ –∏–∑ Registry –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ

