# Спецификация микросервиса агрегации и маршрутизации WebSocket данных Bybit (WebSocket Gateway)

## Что делает микросервис

- Устанавливает и поддерживает единое WebSocket-соединение с Bybit (основной или тестнет), аутентифицируется через API-ключи.
- Поддерживает автоматическое переподключение и heartbeat для надёжной работы с WebSocket.
- Подписывается на множество каналов WebSocket: сделки, тикеры, стаканы, статусы ордеров, балансы и другие (храня данные о подписках чтобы переподписаться заново в случае сбоя).
- Получает данные в формате JSON с уникальными идентификаторами, типами событий, временными метками и полезной нагрузкой.
- Управляет динамическими подписками по запросам от соседних микросервисов через внешний REST API.
- Обеспечивает подписчикам (сервис модели, сервис ордер-менеджер, и другие) доставку свежих и структурированных событий из очередей.
- Помещает полученные события в соответствующие очереди, разделяя их по классам событий (для обеспечения масштабируемости и удобства обработки).
- Часть входящих данных из websocket-каналов (например, данные балансе или об остатках на счетах) может сразу помещать в БД.
- Логирует события, WebSocket-сообщения и REST-запросы для мониторинга и отладки.
- Масштабируется для поддержки множества подписчиков без дублирования соединений к бирже.
